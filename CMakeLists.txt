project(matplotlib-cpp11)
cmake_minimum_required(VERSION 3.0)

find_package(PythonLibs 3 REQUIRED)
find_package(PythonInterp 3 REQUIRED)
find_package(pybind11 REQUIRED)

if(NOT DEFINED ADD_DEMO)
  set(ADD_DEMO ON)
endif()

function(add_demo name path)
  add_executable(${name} ${path})
  target_include_directories(${name} PUBLIC ${pybind11_INCLUDE_DIR} ${PYTHON_INCLUDE_DIRS} include/)
  target_link_libraries(${name} ${PYTHON_LIBRARY} pybind11::embed)
endfunction()

if(${ADD_DEMO})
  set(CMAKE_CXX_STANDARD 17)
  set(CMAKE_CXX_FLAGS "-Wall -g")
  add_demo(fill gallery/lines_bars_and_markers/fill.cpp)
  add_demo(simple_plot gallery/lines_bars_and_markers/simple_plot.cpp)
  add_demo(scatter_symbol gallery/lines_bars_and_markers/scatter_symbol.cpp)
  add_demo(fill_between_demo gallery/lines_bars_and_markers/fill_between_demo.cpp)
  add_demo(fill_betweenx_demo gallery/lines_bars_and_markers/fill_betweenx_demo.cpp)
  add_demo(align_labels_demo gallery/subplots_axes_and_figures/align_labels_demo.cpp)
endif()

if(NOT DEFINED DO_TEST)
  set(DO_TEST ON)
endif()

if(${DO_TEST})
  add_subdirectory(tests)
endif()
